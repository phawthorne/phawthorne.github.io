ROOT Workflow
=============

This section describes the steps in the ROOT analyis.


Overview
---------


Key terms
----------
.. glossary::

    Activity
        ROOT is used to inform spatial decisions about where to undertake different management actions or changes. We use the term "activity" to refer generally to any action, investment, or decision that needs to be spatially allocated. The result of a single optimization from ROOT will be a table indicating which activities, if any, to assign to each spatial decision unit. Some of these activities may not require any physical action (e.g. allocation of protection to natural areas).

    Factor
        The analyses that ROOT performs are based on characteristics of each spatial decision unit and activity that determine whether an activity allocation is good for the specified objectives, or obeys rules (constraints) that the decision is subject to. We refer generally to any of these characteristics as a 'factor'. Specifically, factors show up as the columns in the tables output from the preprocessing steps, and are calculated from the raster and shape inputs.

    Spatial decision unit (SDU)
        Rather than making pixel-level decisions, ROOT optimizes activity allocation at a more aggregated spatial scale. The unit of decision is called the spatial decision unit (SDU). These can be customized by the user, or ROOT can create a grid of equal-area squares or hexagons.

    Agreement map
        A full run of ROOT generally entails many separate optimizations, each with different weights assigned to the objectives. The agreement map is a summary output that indicates how often the same allocation is made regardless of the particular weights. This allows the user to identify allocations that make sense across a wide range of preferences and those that are much more sensitive. 


Data preparation
----------------


Preprocessing
--------------
The preprocessing step converts the spatial input data to a tabular form that summarizes the input data at the SDU level, as needed by the optimization step. This section describes each of the types of data inputs and how they are used.

SDU map
~~~~~~~~
The map of spatial decision units can either be provided by the user as a custom map, or generated automatically by ROOT as a regular grid of squares or hexagons. A user provided map makes sense when there are relevant decision boundaries, e.g. subwatershed outlines, a list of proposed projects, or political/ownership parcels. For a more generalized analysis, ROOT can generate a map of equal-area squares or hexagons.

Activity boundary rasters
~~~~~~~~~~~~~~~~~~~~~~~~~
These are rasters, one per activity, that indicate potential locations for that activity. When a particular activity is allocated to an SDU, ROOT will treat it as applying only the pixels (grid cells) indicated by the activity mask. That means only the values from the impact potential rasters that overlap with the potential activity pixels will be counted.

The criteria used to construct the activity boundary rasters will depend on the decision context and the activity in question.

Impact potential rasters
~~~~~~~

Raster data captures spatially-explicit value of a given activity towards a given factor. For each raster, the preprocessing step will calculate the total score per SDU by summing all the pixels that overlap with allowed pixels in the corresponding mask.

The impact potential rasters can be generated in many different ways, and ROOT places no requirements on the source of the data. One important consideration is whether to use absolute or relative values. For example, for the service of carbon storage, the rasters could either contain values of expected mass of carbon for each land use, or contain the expected change from baseline for each activity. It is probably easier to choose one approach and apply it across all factors for the sake of consistency, but if a problem is more suited to a mixture of approaches, ROOT will still operate correctly.

**Figure: Raster data + Activity Mask + SDU grid --> activity value table**

Shapefiles
~~~~~~~~~~

Shapefiles are used to provide non-activity related data, such as defining spatially dependent weights for different factors, or defining regions for setting targets or constraints. For each shapefile, the user will indicate which fields


Optimization
------------


Outputs
--------
